<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		.box{
			width:150px;
			height:150px;
			float:left;
			margin:10px;
		}
		.box img{
			width:100px;
		}
	</style>
</head>
<body>
	<div>
		欢迎<span id='nowUser'></span>登录，
		<input type="button" value="退出" id='logout' name="">
		<input type="button" value="显示联系人" id='show' name="">
	</div>
	<div id="addBox">
		<input type="text" id='name' name="">
		<input type="text" id='age' name="">
		<input type="button" value="add" id='addBtn' name="">
	</div>
	<div id="showContent">
		<!-- <div class='box'>
			<img src="">
			<span>a</span>
			<input type="button" value="删除" name="">
		</div>  -->
	</div>
	<script type="text/javascript">
		// 阻止非法登录
		if(window.localStorage.getItem('hx180301nowUser')==null){
			alert('请先登录')
			window.location.href = 'login.html';
		}else{
			var nowUser = window.localStorage.getItem('hx180301nowUser');
		}
		
		var aContact = window.localStorage.getItem('hx180301aContact')?JSON.parse(window.localStorage.getItem('hx180301aContact')):[];
		document.getElementById('nowUser').innerHTML = nowUser;
		/**
		 * 1、获取添加按钮，安装点击事件
		 * 2、获取输入框里面的值
		 * 3、构建联系人对象（姓名，年龄，归属）
		 * 4、将对象放进联系人数组中
		 * 5、将数组转串之后存到本地存储
		 */
		var oAddBtn = document.getElementById('addBtn');
		oAddBtn.onclick = function(){
			var nameValue = document.getElementById('name').value;
			var ageValue = document.getElementById('age').value;
			var obj = {
				name:nameValue,
				age:ageValue,
				belong:nowUser
			}
			aContact.push(obj);
			window.localStorage.setItem('hx180301aContact',JSON.stringify(aContact));
			alert('添加成功');

		}

		/**
		 * 退出功能
		 * 1、获取退出按钮，安装点击事件
		 * 2、删除本地存储中的记录（登录记录）
		 * 3、跳转到登录页面
		 */
		var oLogout = document.getElementById('logout');
		oLogout.onclick = function(){
			window.localStorage.removeItem('hx180301nowUser');
			window.location.reload();//页面重新加载（刷新）
		}

		var oShow = document.getElementById('show');
		var oShowContent = document.getElementById('showContent');
		oShow.onclick = function() {
			var ary = [];

			for (var i = 0; i < aContact.length; i++) {
				if (aContact[i].belong == nowUser) {
					ary.push(aContact[i]);
				}
			}
			for (var j = 0; j < ary.length; j++) {
				var oDiv = document.createElement('div');
				var oImg = document.createElement('img');
				oDiv.className = 'box';
				oImg.src = 'Koala.jpg';

				oDiv.appendChild(oImg);
				oShowContent.appendChild(oDiv);

			}
		}
		
	</script>
</body>
</html>